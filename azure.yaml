# yaml-language-server: $schema=https://raw.githubusercontent.com/Azure/azure-dev/main/schemas/v1.0/azure.yaml.json

name: cosmos-db-mongodb-nodejs-quickstart
metadata:
  template: cosmos-db-mongodb-nodejs-quickstart

hooks:
  postprovision:
    posix:
      shell: sh
      run: |
        echo "Creating root .env file from azd environment variables..."
        azd env get-values > .env
        echo "‚úÖ Root .env file created successfully"
        echo ""
        echo "Loading environment variables into hook process..."
        eval "$(azd env get-values)"
        echo "‚úÖ Environment variables loaded:"
        echo "  AZURE_ENV_NAME=$AZURE_ENV_NAME"
        echo "  AZURE_LOCATION=$AZURE_LOCATION" 
        echo "  AZURE_RESOURCE_GROUP=$AZURE_RESOURCE_GROUP"
        echo "  AZURE_COSMOS_DB_MONGODB_DATABASE_NAME=$AZURE_COSMOS_DB_MONGODB_DATABASE_NAME"
        echo "  AZURE_COSMOS_DB_MONGODB_COLLECTION_NAME=$AZURE_COSMOS_DB_MONGODB_COLLECTION_NAME"
        echo ""
        echo "üìÅ .env file created with all variables for workspace packages"
        echo "üîÑ To load these variables into your current shell, run:"
        echo "    source ./load-azure-env.sh"
        echo "    # or"
        echo "    eval \"\$(azd env get-values)\""

services:
pipeline:
  provider: github